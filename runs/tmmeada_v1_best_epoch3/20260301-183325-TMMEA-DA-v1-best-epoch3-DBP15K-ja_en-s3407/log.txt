[RUN] D:\Anaconda_envs\envs\bysj-meaformer\python.exe main.py --gpu 0 --eval_epoch 1 --only_test 0 --model_name MEAformer --data_choice DBP15K --data_split ja_en --data_rate 0.3 --epoch 3 --lr 0.0003 --hidden_units 64,64,64 --save_model 0 --batch_size 32 --csls_k 3 --random_seed 3407 --exp_name BYSJ_TMMEA_DA_v1_best_epoch3_multiseed --exp_id v1_best_ja_en_sweep_select_epoch3_s3407 --workers 1 --dist 0 --accumulation_steps 1 --scheduler cos --attr_dim 64 --img_dim 64 --name_dim 64 --char_dim 64 --hidden_size 64 --tau 0.1 --structure_encoder gat --num_attention_heads 1 --num_hidden_layers 1 --use_surface 0 --use_intermediate 1 --replay 0 --use_domain_align 1 --domain_align_weight 0.1 --use_source_select 1 --source_select_weight 0.05 --source_select_temp 1.0 --use_missing_gate 1 --missing_align_weight 0.1 --csls
The syntax of the command is incorrect.
INFO - 03/01/26 18:33:28 - 0:00:00 - ============ Initialized logger ============
INFO - 03/01/26 18:33:28 - 0:00:00 - The experiment will be stored in D:\code\codes\cursor\BYSJ_zyf\data\mmkg\dump/0301-BYSJ_TMMEA_DA_v1_best_epoch3_multiseed\MEAformer_DBP15K_ja_en_v1_best_ja_en_sweep_select_epoch3_s3407

INFO - 03/01/26 18:33:28 - 0:00:00 - Running command: python main.py --gpu 0 --eval_epoch 1 --only_test 0 --model_name MEAformer --data_choice DBP15K --data_split ja_en --data_rate '0.3' --epoch 3 --lr '0.0003' --hidden_units '64,64,64' --save_model 0 --batch_size 32 --csls_k 3 --random_seed 3407 --exp_name BYSJ_TMMEA_DA_v1_best_epoch3_multiseed --exp_id v1_best_ja_en_sweep_select_epoch3_s3407 --workers 1 --dist 0 --accumulation_steps 1 --scheduler cos --attr_dim 64 --img_dim 64 --name_dim 64 --char_dim 64 --hidden_size 64 --tau '0.1' --structure_encoder gat --num_attention_heads 1 --num_hidden_layers 1 --use_surface 0 --use_intermediate 1 --replay 0 --use_domain_align 1 --domain_align_weight '0.1' --use_source_select 1 --source_select_weight '0.05' --source_select_temp '1.0' --use_missing_gate 1 --missing_align_weight '0.1' --csls

D:\code\codes\cursor\BYSJ_zyf\baselines\MEAformer\main.py:41: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = GradScaler()
INFO - 03/01/26 18:33:30 - 0:00:02 - 66.88% entities have images
INFO - 03/01/26 18:33:30 - 0:00:02 - image feature shape:(39594, 2048)
INFO - 03/01/26 18:33:30 - 0:00:02 - #left entity : 19814, #right entity: 19780
INFO - 03/01/26 18:33:30 - 0:00:02 - #left entity not in train set: 15314, #right entity not in train set: 15280
INFO - 03/01/26 18:33:30 - 0:00:02 - relation feature shape:(39594, 1000)
INFO - 03/01/26 18:33:31 - 0:00:03 - attribute feature shape:(39594, 1000)
INFO - 03/01/26 18:33:31 - 0:00:03 - -----dataset summary-----
INFO - 03/01/26 18:33:31 - 0:00:03 - dataset:		 D:\code\codes\cursor\BYSJ_zyf\data\mmkg\DBP15K\ja_en
INFO - 03/01/26 18:33:31 - 0:00:03 - triple num:	 170698
INFO - 03/01/26 18:33:31 - 0:00:03 - entity num:	 39594
INFO - 03/01/26 18:33:31 - 0:00:03 - relation num:	 2452
INFO - 03/01/26 18:33:31 - 0:00:03 - train ill num:	 4500 	 test ill num:	 10500
INFO - 03/01/26 18:33:31 - 0:00:03 - -------------------------
D:\code\codes\cursor\BYSJ_zyf\baselines\MEAformer\src\utils.py:237: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at C:\actions-runner\_work\pytorch\pytorch\pytorch\torch\csrc\utils\tensor_new.cpp:655.)
  return torch.sparse.FloatTensor(indices, values, shape)
INFO - 03/01/26 18:33:31 - 0:00:03 - Random init...
INFO - 03/01/26 18:33:31 - 0:00:03 - total params num: 2888342
INFO - 03/01/26 18:33:31 - 0:00:03 - warmup_steps: 63
INFO - 03/01/26 18:33:31 - 0:00:03 - total_steps: 423
INFO - 03/01/26 18:33:31 - 0:00:03 - weight_decay: 0.0001
loading raw data...
getting a sparse tensor r_adj...

  0%|          | 0/3 [00:00<?, ?it/s]
Train | Ep [0/3] Step [142/423] LR [0.00027] Loss 3321.82915 :   0%|          | 0/3 [13:39<?, ?it/s]INFO - 03/01/26 18:47:18 - 0:13:50 - Ep 0 | l2r: acc of top [1, 10, 50] = [0.5528 0.8488 0.9561], mr = 10.856, mrr = 0.653, Loss = 3321.8292
INFO - 03/01/26 18:47:18 - 0:13:50 - Ep 0 | r2l: acc of top [1, 10, 50] = [0.5516 0.8463 0.9596], mr = 9.686, mrr = 0.654, Loss = 3321.8292
INFO - 03/01/26 18:47:18 - 0:13:50 - Best model update in Ep 0: MRR from [0.0] --> [0.6531710989486788] ...

Train | Ep [0/3] Step [142/423] LR [0.00027] Loss 3321.82915 :  33%|��������      | 1/3 [13:45<27:31, 825.67s/it]
Train | Ep [1/3] Step [283/423] LR [0.00010] Loss 1366.73501 :  33%|��������      | 1/3 [27:13<27:31, 825.67s/it]INFO - 03/01/26 19:00:51 - 0:27:23 - Ep 1 | l2r: acc of top [1, 10, 50] = [0.6026 0.8786 0.9731], mr = 7.483, mrr = 0.696, Loss = 1366.7350
INFO - 03/01/26 19:00:51 - 0:27:23 - Ep 1 | r2l: acc of top [1, 10, 50] = [0.6014 0.8758 0.973 ], mr = 7.035, mrr = 0.695, Loss = 1366.7350
INFO - 03/01/26 19:00:51 - 0:27:23 - Best model update in Ep 1: MRR from [0.6531710989486788] --> [0.6956942156570329] ...

Train | Ep [1/3] Step [283/423] LR [0.00010] Loss 1366.73501 :  67%|��������������   | 2/3 [27:18<13:38, 818.22s/it]
Train | Ep [2/3] Step [424/423] LR [0.00000] Loss 1030.79817 :  67%|��������������   | 2/3 [40:32<13:38, 818.22s/it]INFO - 03/01/26 19:14:11 - 0:40:43 - Ep 2 | l2r: acc of top [1, 10, 50] = [0.5905 0.8695 0.9695], mr = 7.914, mrr = 0.684, Loss = 1030.7982
INFO - 03/01/26 19:14:11 - 0:40:43 - Ep 2 | r2l: acc of top [1, 10, 50] = [0.5851 0.8675 0.97  ], mr = 7.595, mrr = 0.681, Loss = 1030.7982

Train | Ep [2/3] Step [424/423] LR [0.00000] Loss 1030.79817 : 100%|��������������������| 3/3 [40:38<00:00, 809.88s/it]
Train | Ep [2/3] Step [424/423] LR [0.00000] Loss 1030.79817 : 100%|��������������������| 3/3 [40:38<00:00, 812.88s/it]
INFO - 03/01/26 19:14:11 - 0:40:43 - load from the best model before final testing ...
INFO - 03/01/26 19:14:11 - 0:40:43 -  --------------------- Test result ---------------------
INFO - 03/01/26 19:14:18 - 0:40:50 - Ep 2 | l2r: acc of top [1, 10, 50] = [0.6026 0.8786 0.9731], mr = 7.483, mrr = 0.696, Loss = 1030.7982
INFO - 03/01/26 19:14:18 - 0:40:50 - Ep 2 | r2l: acc of top [1, 10, 50] = [0.6014 0.8758 0.973 ], mr = 7.035, mrr = 0.695, Loss = 1030.7982
INFO - 03/01/26 19:14:18 - 0:40:50 - min loss 1030.7981719970703
INFO - 03/01/26 19:14:18 - 0:40:50 - done!
[DONE] return_code=0
